<nav class="md-nav md-nav--primary" data-md-level="0">
  <!-- 站点标题 -->
  <label class="md-nav__title" for="__drawer">
    <a href="{{ '/' | relative_url }}" title="{{ site.title }}" class="md-nav__button md-logo">
      <i class="material-icons">school</i>
      {{ site.title }}
    </a>
  </label>

  <!-- 主导航 -->
  <ul class="md-nav__list" data-md-scrollfix>
    <!-- 主页 -->
    <li class="md-nav__item">
      <a href="{{ '/' | relative_url }}" class="md-nav__link {% if page.url == '/' %}md-nav__link--active{% endif %}">
        <span class="md-nav__icon">
          <i class="material-icons">home</i>
        </span>
        首页
      </a>
    </li>

    <!-- 书籍列表 -->
    {% for book in site.books %}
      {% assign book_dir = book.dir %}
      {% assign book_pages = site.pages | where_exp: "item", "item.path contains book_dir" | sort: "path" %}

      <li class="md-nav__item md-nav__item--nested">
        <input class="md-toggle md-nav__toggle" type="checkbox" id="nav-{{ forloop.index }}">
        <label class="md-nav__link" for="nav-{{ forloop.index }}">
          <span class="md-nav__icon">
            <i class="material-icons">{{ book.icon }}</i>
          </span>
          {{ book.name }}
        </label>

        <nav class="md-nav">
          <ul class="md-nav__list">
            {% for chapter in book_pages %}
              {% unless chapter.path contains '/README.md' %}
                <li class="md-nav__item">
                  <a href="{{ chapter.url | relative_url }}"
                     class="md-nav__link {% if page.url == chapter.url %}md-nav__link--active{% endif %}">
                    {{ chapter.title }}
                  </a>
                </li>
              {% else %}
                <!-- 书籍首页 -->
                <li class="md-nav__item">
                  <a href="{{ chapter.url | relative_url }}"
                     class="md-nav__link {% if page.url == chapter.url %}md-nav__link--active{% endif %}">
                    开始阅读
                  </a>
                </li>
              {% endunless %}
            {% endfor %}
          </ul>
        </nav>
      </li>
    {% endfor %}
  </ul>
</nav>