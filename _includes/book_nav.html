{% assign current_book = nil %}
{% for book in site.books %}
  {% if page.path contains book.dir %}
    {% assign current_book = book %}
    {% break %}
  {% endif %}
{% endfor %}

{% if current_book %}
  {% assign book_pages = site.pages | where_exp: "item", "item.path contains current_book.dir" | sort: "path" %}

  <ul class="book-toc">
    {% for chapter in book_pages %}
      {% if chapter.path contains '/README.md' %}
        <li class="toc-item toc-item--home {% if page.url == chapter.url %}active{% endif %}">
          <a href="{{ chapter.url | relative_url }}">
            <span class="toc-icon">ðŸ“–</span>
            {{ current_book.name }} - é¦–é¡µ
          </a>
        </li>
      {% else %}
        <li class="toc-item {% if page.url == chapter.url %}active{% endif %}">
          <a href="{{ chapter.url | relative_url }}">
            {{ chapter.title }}
          </a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
{% endif %}